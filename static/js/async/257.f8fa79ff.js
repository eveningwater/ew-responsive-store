"use strict";(self.webpackChunkew_responsive_store_docs=self.webpackChunkew_responsive_store_docs||[]).push([["257"],{3461:function(e,n,t){t.r(n),t.d(n,{default:()=>i});var o=t(2676),r=t(453);function s(e){let n=Object.assign({h1:"h1",a:"a",p:"p",code:"code",h2:"h2",pre:"pre",h3:"h3"},(0,r.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.h1,{id:"示例",children:["示例",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#示例",children:"#"})]}),"\n",(0,o.jsxs)(n.p,{children:["本节提供了在不同场景中使用 ",(0,o.jsx)(n.code,{children:"ew-responsive-store"})," 的实用示例。"]}),"\n",(0,o.jsxs)(n.h2,{id:"基础计数器示例",children:["基础计数器示例",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#基础计数器示例",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"一个简单的计数器，其值在 localStorage 中持久化："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { useStorage } from "ew-responsive-store";\n\n// 初始化一个计数器，默认值为 0\nconst counter = useStorage("counter", 0);\n\n// 增加计数器\nfunction increment() {\n  counter.value++;\n}\n\n// 减少计数器\nfunction decrement() {\n  counter.value--;\n}\n\n// 重置计数器\nfunction reset() {\n  counter.value = 0;\n}\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"用户偏好设置",children:["用户偏好设置",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#用户偏好设置",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"管理在会话之间持久化的用户偏好设置："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { useStorage } from "ew-responsive-store";\nimport { StoreType } from "ew-responsive-store/typings/core/enum";\n\n// 初始化用户偏好设置，设置默认值\nconst preferences = useStorage("userPreferences", {\n  theme: "light",\n  fontSize: "medium",\n  notifications: true,\n});\n\n// 在亮色和暗色主题之间切换\nfunction toggleTheme() {\n  preferences.value.theme =\n    preferences.value.theme === "light" ? "dark" : "light";\n}\n\n// 更改字体大小\nfunction setFontSize(size) {\n  preferences.value.fontSize = size; // \'small\', \'medium\', 或 \'large\'\n}\n\n// 切换通知\nfunction toggleNotifications() {\n  preferences.value.notifications = !preferences.value.notifications;\n}\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"购物车",children:["购物车",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#购物车",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"实现在页面刷新之间持久化商品的购物车："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { useStorage } from "ew-responsive-store";\n\n// 初始化一个空购物车\nconst cart = useStorage("shoppingCart", []);\n\n// 向购物车添加商品\nfunction addToCart(product) {\n  const existingItem = cart.value.find((item) => item.id === product.id);\n\n  if (existingItem) {\n    // 如果商品已存在，增加其数量\n    existingItem.quantity += 1;\n  } else {\n    // 否则，添加新商品，数量为 1\n    cart.value.push({\n      ...product,\n      quantity: 1,\n    });\n  }\n}\n\n// 从购物车移除商品\nfunction removeFromCart(productId) {\n  const index = cart.value.findIndex((item) => item.id === productId);\n\n  if (index !== -1) {\n    cart.value.splice(index, 1);\n  }\n}\n\n// 更新商品数量\nfunction updateQuantity(productId, quantity) {\n  const item = cart.value.find((item) => item.id === productId);\n\n  if (item) {\n    item.quantity = quantity;\n  }\n}\n\n// 清空整个购物车\nfunction clearCart() {\n  cart.value = [];\n}\n\n// 计算购物车中商品的总价\nfunction getCartTotal() {\n  return cart.value.reduce(\n    (total, item) => total + item.price * item.quantity,\n    0\n  );\n}\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"表单状态持久化",children:["表单状态持久化",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#表单状态持久化",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"保存表单状态，防止在导航离开时数据丢失："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { useStorage } from "ew-responsive-store";\nimport { StoreType } from "ew-responsive-store/typings/core/enum";\n\n// 使用 sessionStorage 存储临时表单数据\nconst formData = useStorage(\n  "contactForm",\n  {\n    name: "",\n    email: "",\n    message: "",\n  },\n  { storage: StoreType.SESSION }\n);\n\n// 更新表单字段\nfunction updateField(field, value) {\n  formData.value[field] = value;\n}\n\n// 提交表单\nfunction submitForm() {\n  // 将数据发送到 API\n  sendToApi(formData.value);\n\n  // 成功提交后清空表单\n  formData.value = {\n    name: "",\n    email: "",\n    message: "",\n  };\n}\n\n// 检查表单是否有数据\nfunction hasFormData() {\n  return (\n    formData.value.name !== "" ||\n    formData.value.email !== "" ||\n    formData.value.message !== ""\n  );\n}\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"与-vuejs-一起使用",children:["与 Vue.js 一起使用",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#与-vuejs-一起使用",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"与 Vue.js 组件集成："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-vue",children:'<template>\n  <div>\n    <h2>主题切换器</h2>\n    <div class="theme-controls">\n      <button @click="toggleTheme">切换主题</button>\n      <p>当前主题: {{ theme }}</p>\n    </div>\n\n    <h2>计数器</h2>\n    <div class="counter-controls">\n      <button @click="decrement">-</button>\n      <span>{{ count }}</span>\n      <button @click="increment">+</button>\n      <button @click="reset">重置</button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { useStorage } from "ew-responsive-store";\nimport { computed } from "vue";\n\n// 主题偏好\nconst preferences = useStorage("preferences", { theme: "light" });\nconst theme = computed(() => preferences.value.theme);\n\nfunction toggleTheme() {\n  preferences.value.theme =\n    preferences.value.theme === "light" ? "dark" : "light";\n}\n\n// 计数器\nconst count = useStorage("count", 0);\n\nfunction increment() {\n  count.value++;\n}\n\nfunction decrement() {\n  count.value--;\n}\n\nfunction reset() {\n  count.value = 0;\n}\n<\/script>\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"与-react-一起使用",children:["与 React 一起使用",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#与-react-一起使用",children:"#"})]}),"\n",(0,o.jsxs)(n.h3,{id:"使用-usereactstorage-的基本-react-示例",children:["使用 useReactStorage 的基本 React 示例",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#使用-usereactstorage-的基本-react-示例",children:"#"})]}),"\n",(0,o.jsxs)(n.p,{children:["在 React 中使用 ",(0,o.jsx)(n.code,{children:"ew-responsive-store"})," 的推荐方式是通过 ",(0,o.jsx)(n.code,{children:"useReactStorage"})," 钩子："]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'import React from "react";\nimport { useReactStorage, StoreType } from "ew-responsive-store";\n\nfunction ThemeSwitcher() {\n  const [theme, setTheme] = useReactStorage("theme", "light");\n  const [count, setCount] = useReactStorage("count", 0);\n\n  const toggleTheme = () => {\n    setTheme(theme === "light" ? "dark" : "light");\n  };\n\n  const increment = () => setCount(count + 1);\n  const decrement = () => setCount(count - 1);\n  const reset = () => setCount(0);\n\n  return (\n    <div className={`app ${theme}`}>\n      <h2>主题切换器</h2>\n      <button onClick={toggleTheme}>切换主题</button>\n      <p>当前主题: {theme}</p>\n      \n      <h2>计数器</h2>\n      <div>\n        <button onClick={decrement}>-</button>\n        <span>{count}</span>\n        <button onClick={increment}>+</button>\n        <button onClick={reset}>重置</button>\n      </div>\n    </div>\n  );\n}\n\nexport default ThemeSwitcher;\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"react-待办事项列表",children:["React 待办事项列表",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#react-待办事项列表",children:"#"})]}),"\n",(0,o.jsxs)(n.p,{children:["使用 ",(0,o.jsx)(n.code,{children:"useReactStorage"})," 的完整待办事项列表示例："]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'import React, { useState } from "react";\nimport { useReactStorage, StoreType } from "ew-responsive-store";\n\ninterface Todo {\n  id: number;\n  text: string;\n  completed: boolean;\n}\n\nfunction TodoApp() {\n  const [todos, setTodos] = useReactStorage<Todo[]>("todos", []);\n  const [inputValue, setInputValue] = useState("");\n\n  const addTodo = () => {\n    if (inputValue.trim()) {\n      const newTodo: Todo = {\n        id: Date.now(),\n        text: inputValue,\n        completed: false,\n      };\n      setTodos([...todos, newTodo]);\n      setInputValue("");\n    }\n  };\n\n  const toggleTodo = (id: number) => {\n    setTodos(\n      todos.map((todo) =>\n        todo.id === id ? { ...todo, completed: !todo.completed } : todo\n      )\n    );\n  };\n\n  const deleteTodo = (id: number) => {\n    setTodos(todos.filter((todo) => todo.id !== id));\n  };\n\n  const clearCompleted = () => {\n    setTodos(todos.filter((todo) => !todo.completed));\n  };\n\n  return (\n    <div>\n      <h1>待办事项列表</h1>\n      \n      <div>\n        <input\n          type="text"\n          value={inputValue}\n          onChange={(e) => setInputValue(e.target.value)}\n          onKeyPress={(e) => e.key === "Enter" && addTodo()}\n          placeholder="添加新的待办事项..."\n        />\n        <button onClick={addTodo}>添加</button>\n      </div>\n\n      <div>\n        <button onClick={clearCompleted}>清除已完成</button>\n        <p>\n          {todos.filter((t) => !t.completed).length} 个待完成，{" "}\n          {todos.filter((t) => t.completed).length} 个已完成\n        </p>\n      </div>\n\n      <ul>\n        {todos.map((todo) => (\n          <li key={todo.id}>\n            <input\n              type="checkbox"\n              checked={todo.completed}\n              onChange={() => toggleTodo(todo.id)}\n            />\n            <span\n              style={{\n                textDecoration: todo.completed ? "line-through" : "none",\n              }}\n            >\n              {todo.text}\n            </span>\n            <button onClick={() => deleteTodo(todo.id)}>删除</button>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport default TodoApp;\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"跨标签页同步",children:["跨标签页同步",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#跨标签页同步",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"React 组件会自动在不同浏览器标签页之间同步："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'import React from "react";\nimport { useReactStorage } from "ew-responsive-store";\n\nfunction MultiTabCounter() {\n  const [count, setCount] = useReactStorage("sharedCounter", 0);\n\n  return (\n    <div>\n      <h2>共享计数器</h2>\n      <p>这个计数器在所有浏览器标签页中同步！</p>\n      <p>计数: {count}</p>\n      <button onClick={() => setCount(count + 1)}>增加</button>\n      <button onClick={() => setCount(count - 1)}>减少</button>\n      <button onClick={() => setCount(0)}>重置</button>\n    </div>\n  );\n}\n\nexport default MultiTabCounter;\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"与-vue-一起使用传统方式",children:["与 Vue 一起使用（传统方式）",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#与-vue-一起使用传统方式",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"如果您需要在 React 中使用 Vue 版本（不推荐），可以这样做："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'import React, { useEffect, useState } from "react";\nimport { useStorage } from "ew-responsive-store";\n\nfunction ThemeSwitcher() {\n  // 初始化存储\n  const preferences = useStorage("preferences", { theme: "light" });\n\n  // 本地状态触发重新渲染\n  const [theme, setTheme] = useState(preferences.value.theme);\n\n  // 当存储变化时更新本地状态\n  useEffect(() => {\n    const updateTheme = () => {\n      setTheme(preferences.value.theme);\n    };\n\n    // 初始更新\n    updateTheme();\n\n    // 订阅变化\n    const unsubscribe = preferences.subscribe(updateTheme);\n\n    // 清理\n    return () => {\n      unsubscribe();\n    };\n  }, []);\n\n  const toggleTheme = () => {\n    preferences.value.theme =\n      preferences.value.theme === "light" ? "dark" : "light";\n  };\n\n  return (\n    <div>\n      <h2>主题切换器</h2>\n      <button onClick={toggleTheme}>切换主题</button>\n      <p>当前主题: {theme}</p>\n    </div>\n  );\n}\n\nexport default ThemeSwitcher;\n'})}),"\n",(0,o.jsxs)(n.h2,{id:"高级用法自定义序列化",children:["高级用法：自定义序列化",(0,o.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#高级用法自定义序列化",children:"#"})]}),"\n",(0,o.jsx)(n.p,{children:"为复杂数据结构使用自定义序列化："}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:'import { useStorage, parseStr } from "ew-responsive-store";\nimport { parseStrType } from "ew-responsive-store/typings/core/enum";\n\n// 为 Date 对象自定义序列化\nconst lastVisit = useStorage("lastVisit", new Date(), {\n  serializer: (date) => date.toISOString(),\n  deserializer: (dateStr) => new Date(dateStr),\n});\n\n// 将最后访问时间更新为现在\nfunction updateLastVisit() {\n  lastVisit.value = new Date();\n}\n\n// 获取最后访问时间的格式化字符串\nfunction getFormattedLastVisit() {\n  return lastVisit.value.toLocaleString();\n}\n'})})]})}function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(s,{...e})}):s(e)}let i=a;a.__RSPRESS_PAGE_META={},a.__RSPRESS_PAGE_META["zh%2Fexamples%2Findex.md"]={toc:[{text:"基础计数器示例",id:"基础计数器示例",depth:2},{text:"用户偏好设置",id:"用户偏好设置",depth:2},{text:"购物车",id:"购物车",depth:2},{text:"表单状态持久化",id:"表单状态持久化",depth:2},{text:"与 Vue.js 一起使用",id:"与-vuejs-一起使用",depth:2},{text:"与 React 一起使用",id:"与-react-一起使用",depth:2},{text:"使用 useReactStorage 的基本 React 示例",id:"使用-usereactstorage-的基本-react-示例",depth:3},{text:"React 待办事项列表",id:"react-待办事项列表",depth:3},{text:"跨标签页同步",id:"跨标签页同步",depth:3},{text:"与 Vue 一起使用（传统方式）",id:"与-vue-一起使用传统方式",depth:3},{text:"高级用法：自定义序列化",id:"高级用法自定义序列化",depth:2}],title:"示例",headingTitle:"示例",frontmatter:{}}}}]);